!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("core-js/modules/es6.array.copy-within"),require("core-js/modules/es6.array.fill"),require("core-js/modules/es6.array.find"),require("core-js/modules/es6.array.find-index"),require("core-js/modules/es6.array.from"),require("core-js/modules/es7.array.includes"),require("core-js/modules/es6.array.iterator"),require("core-js/modules/es6.array.of"),require("core-js/modules/es6.array.sort"),require("core-js/modules/es6.array.species"),require("core-js/modules/es6.date.to-primitive"),require("core-js/modules/es6.function.has-instance"),require("core-js/modules/es6.function.name"),require("core-js/modules/es6.map"),require("core-js/modules/es6.math.acosh"),require("core-js/modules/es6.math.asinh"),require("core-js/modules/es6.math.atanh"),require("core-js/modules/es6.math.cbrt"),require("core-js/modules/es6.math.clz32"),require("core-js/modules/es6.math.cosh"),require("core-js/modules/es6.math.expm1"),require("core-js/modules/es6.math.fround"),require("core-js/modules/es6.math.hypot"),require("core-js/modules/es6.math.imul"),require("core-js/modules/es6.math.log1p"),require("core-js/modules/es6.math.log10"),require("core-js/modules/es6.math.log2"),require("core-js/modules/es6.math.sign"),require("core-js/modules/es6.math.sinh"),require("core-js/modules/es6.math.tanh"),require("core-js/modules/es6.math.trunc"),require("core-js/modules/es6.number.constructor"),require("core-js/modules/es6.number.epsilon"),require("core-js/modules/es6.number.is-finite"),require("core-js/modules/es6.number.is-integer"),require("core-js/modules/es6.number.is-nan"),require("core-js/modules/es6.number.is-safe-integer"),require("core-js/modules/es6.number.max-safe-integer"),require("core-js/modules/es6.number.min-safe-integer"),require("core-js/modules/es6.number.parse-float"),require("core-js/modules/es6.number.parse-int"),require("core-js/modules/es6.object.assign"),require("core-js/modules/es7.object.define-getter"),require("core-js/modules/es7.object.define-setter"),require("core-js/modules/es7.object.entries"),require("core-js/modules/es6.object.freeze"),require("core-js/modules/es6.object.get-own-property-descriptor"),require("core-js/modules/es7.object.get-own-property-descriptors"),require("core-js/modules/es6.object.get-own-property-names"),require("core-js/modules/es6.object.get-prototype-of"),require("core-js/modules/es7.object.lookup-getter"),require("core-js/modules/es7.object.lookup-setter"),require("core-js/modules/es6.object.prevent-extensions"),require("core-js/modules/es6.object.is"),require("core-js/modules/es6.object.is-frozen"),require("core-js/modules/es6.object.is-sealed"),require("core-js/modules/es6.object.is-extensible"),require("core-js/modules/es6.object.keys"),require("core-js/modules/es6.object.seal"),require("core-js/modules/es7.object.values"),require("core-js/modules/es6.promise"),require("core-js/modules/es7.promise.finally"),require("core-js/modules/es6.reflect.apply"),require("core-js/modules/es6.reflect.construct"),require("core-js/modules/es6.reflect.define-property"),require("core-js/modules/es6.reflect.delete-property"),require("core-js/modules/es6.reflect.get"),require("core-js/modules/es6.reflect.get-own-property-descriptor"),require("core-js/modules/es6.reflect.get-prototype-of"),require("core-js/modules/es6.reflect.has"),require("core-js/modules/es6.reflect.is-extensible"),require("core-js/modules/es6.reflect.own-keys"),require("core-js/modules/es6.reflect.prevent-extensions"),require("core-js/modules/es6.reflect.set"),require("core-js/modules/es6.reflect.set-prototype-of"),require("core-js/modules/es6.regexp.constructor"),require("core-js/modules/es6.regexp.flags"),require("core-js/modules/es6.regexp.match"),require("core-js/modules/es6.regexp.replace"),require("core-js/modules/es6.regexp.split"),require("core-js/modules/es6.regexp.search"),require("core-js/modules/es6.regexp.to-string"),require("core-js/modules/es6.set"),require("core-js/modules/es6.symbol"),require("core-js/modules/es7.symbol.async-iterator"),require("core-js/modules/es6.string.anchor"),require("core-js/modules/es6.string.big"),require("core-js/modules/es6.string.blink"),require("core-js/modules/es6.string.bold"),require("core-js/modules/es6.string.code-point-at"),require("core-js/modules/es6.string.ends-with"),require("core-js/modules/es6.string.fixed"),require("core-js/modules/es6.string.fontcolor"),require("core-js/modules/es6.string.fontsize"),require("core-js/modules/es6.string.from-code-point"),require("core-js/modules/es6.string.includes"),require("core-js/modules/es6.string.italics"),require("core-js/modules/es6.string.iterator"),require("core-js/modules/es6.string.link"),require("core-js/modules/es7.string.pad-start"),require("core-js/modules/es7.string.pad-end"),require("core-js/modules/es6.string.raw"),require("core-js/modules/es6.string.repeat"),require("core-js/modules/es6.string.small"),require("core-js/modules/es6.string.starts-with"),require("core-js/modules/es6.string.strike"),require("core-js/modules/es6.string.sub"),require("core-js/modules/es6.string.sup"),require("core-js/modules/es6.typed.array-buffer"),require("core-js/modules/es6.typed.int8-array"),require("core-js/modules/es6.typed.uint8-array"),require("core-js/modules/es6.typed.uint8-clamped-array"),require("core-js/modules/es6.typed.int16-array"),require("core-js/modules/es6.typed.uint16-array"),require("core-js/modules/es6.typed.int32-array"),require("core-js/modules/es6.typed.uint32-array"),require("core-js/modules/es6.typed.float32-array"),require("core-js/modules/es6.typed.float64-array"),require("core-js/modules/es6.weak-map"),require("core-js/modules/es6.weak-set"),require("core-js/modules/web.timers"),require("core-js/modules/web.immediate"),require("core-js/modules/web.dom.iterable"),require("regenerator-runtime/runtime"),require("d3-request"),require("d3-dsv")):"function"==typeof define&&define.amd?define(["exports","core-js/modules/es6.array.copy-within","core-js/modules/es6.array.fill","core-js/modules/es6.array.find","core-js/modules/es6.array.find-index","core-js/modules/es6.array.from","core-js/modules/es7.array.includes","core-js/modules/es6.array.iterator","core-js/modules/es6.array.of","core-js/modules/es6.array.sort","core-js/modules/es6.array.species","core-js/modules/es6.date.to-primitive","core-js/modules/es6.function.has-instance","core-js/modules/es6.function.name","core-js/modules/es6.map","core-js/modules/es6.math.acosh","core-js/modules/es6.math.asinh","core-js/modules/es6.math.atanh","core-js/modules/es6.math.cbrt","core-js/modules/es6.math.clz32","core-js/modules/es6.math.cosh","core-js/modules/es6.math.expm1","core-js/modules/es6.math.fround","core-js/modules/es6.math.hypot","core-js/modules/es6.math.imul","core-js/modules/es6.math.log1p","core-js/modules/es6.math.log10","core-js/modules/es6.math.log2","core-js/modules/es6.math.sign","core-js/modules/es6.math.sinh","core-js/modules/es6.math.tanh","core-js/modules/es6.math.trunc","core-js/modules/es6.number.constructor","core-js/modules/es6.number.epsilon","core-js/modules/es6.number.is-finite","core-js/modules/es6.number.is-integer","core-js/modules/es6.number.is-nan","core-js/modules/es6.number.is-safe-integer","core-js/modules/es6.number.max-safe-integer","core-js/modules/es6.number.min-safe-integer","core-js/modules/es6.number.parse-float","core-js/modules/es6.number.parse-int","core-js/modules/es6.object.assign","core-js/modules/es7.object.define-getter","core-js/modules/es7.object.define-setter","core-js/modules/es7.object.entries","core-js/modules/es6.object.freeze","core-js/modules/es6.object.get-own-property-descriptor","core-js/modules/es7.object.get-own-property-descriptors","core-js/modules/es6.object.get-own-property-names","core-js/modules/es6.object.get-prototype-of","core-js/modules/es7.object.lookup-getter","core-js/modules/es7.object.lookup-setter","core-js/modules/es6.object.prevent-extensions","core-js/modules/es6.object.is","core-js/modules/es6.object.is-frozen","core-js/modules/es6.object.is-sealed","core-js/modules/es6.object.is-extensible","core-js/modules/es6.object.keys","core-js/modules/es6.object.seal","core-js/modules/es7.object.values","core-js/modules/es6.promise","core-js/modules/es7.promise.finally","core-js/modules/es6.reflect.apply","core-js/modules/es6.reflect.construct","core-js/modules/es6.reflect.define-property","core-js/modules/es6.reflect.delete-property","core-js/modules/es6.reflect.get","core-js/modules/es6.reflect.get-own-property-descriptor","core-js/modules/es6.reflect.get-prototype-of","core-js/modules/es6.reflect.has","core-js/modules/es6.reflect.is-extensible","core-js/modules/es6.reflect.own-keys","core-js/modules/es6.reflect.prevent-extensions","core-js/modules/es6.reflect.set","core-js/modules/es6.reflect.set-prototype-of","core-js/modules/es6.regexp.constructor","core-js/modules/es6.regexp.flags","core-js/modules/es6.regexp.match","core-js/modules/es6.regexp.replace","core-js/modules/es6.regexp.split","core-js/modules/es6.regexp.search","core-js/modules/es6.regexp.to-string","core-js/modules/es6.set","core-js/modules/es6.symbol","core-js/modules/es7.symbol.async-iterator","core-js/modules/es6.string.anchor","core-js/modules/es6.string.big","core-js/modules/es6.string.blink","core-js/modules/es6.string.bold","core-js/modules/es6.string.code-point-at","core-js/modules/es6.string.ends-with","core-js/modules/es6.string.fixed","core-js/modules/es6.string.fontcolor","core-js/modules/es6.string.fontsize","core-js/modules/es6.string.from-code-point","core-js/modules/es6.string.includes","core-js/modules/es6.string.italics","core-js/modules/es6.string.iterator","core-js/modules/es6.string.link","core-js/modules/es7.string.pad-start","core-js/modules/es7.string.pad-end","core-js/modules/es6.string.raw","core-js/modules/es6.string.repeat","core-js/modules/es6.string.small","core-js/modules/es6.string.starts-with","core-js/modules/es6.string.strike","core-js/modules/es6.string.sub","core-js/modules/es6.string.sup","core-js/modules/es6.typed.array-buffer","core-js/modules/es6.typed.int8-array","core-js/modules/es6.typed.uint8-array","core-js/modules/es6.typed.uint8-clamped-array","core-js/modules/es6.typed.int16-array","core-js/modules/es6.typed.uint16-array","core-js/modules/es6.typed.int32-array","core-js/modules/es6.typed.uint32-array","core-js/modules/es6.typed.float32-array","core-js/modules/es6.typed.float64-array","core-js/modules/es6.weak-map","core-js/modules/es6.weak-set","core-js/modules/web.timers","core-js/modules/web.immediate","core-js/modules/web.dom.iterable","regenerator-runtime/runtime","d3-request","d3-dsv"],r):r((e=e||self).dfjs={},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,e.d3Request,e.d3Dsv)}(this,function(e,r,t,n,o,u,s,i,c,l,a,f,m,d,h,p,y,v,j,g,b,w,_,k,q,O,A,x,S,E,I,N,C,T,R,D,F,J,P,M,U,L,V,B,z,G,W,Y,H,K,Q,Z,X,$,ee,re,te,ne,oe,ue,se,ie,ce,le,ae,fe,me,de,he,pe,ye,ve,je,ge,be,we,_e,ke,qe,Oe,Ae,xe,Se,Ee,Ie,Ne,Ce,Te,Re,De,Fe,Je,Pe,Me,Ue,Le,Ve,Be,ze,Ge,We,Ye,He,Ke,Qe,Ze,Xe,$e,er,rr,tr,nr,or,ur,sr,ir,cr,lr,ar,fr,mr,dr,hr,pr,yr,vr,jr){"use strict";function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function br(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function wr(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _r(e,r,t){return r&&wr(e.prototype,r),t&&wr(e,t),e}function kr(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function qr(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(e){kr(r,e,t[e])})}return r}function Or(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&xr(e,r)}function Ar(e){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xr(e,r){return(xr=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function Sr(e,r,t){return(Sr=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,r,t){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(e,n));return t&&xr(o,t.prototype),o}).apply(null,arguments)}function Er(e){var n="function"==typeof Map?new Map:void 0;return(Er=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return Sr(e,arguments,Ar(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),xr(t,e)})(e)}function Ir(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],0<=r.indexOf(t)||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],0<=r.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function Nr(e,r){return!r||"object"!=typeof r&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):r}function Cr(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(t.push(s.value),!r||t.length!==r);n=!0);}catch(e){o=!0,u=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw u}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Tr(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Rr=regeneratorRuntime.mark(Ur),Dr=regeneratorRuntime.mark(Vr);function Fr(e){return e?Array.isArray(e)?e:[e]:[]}function Jr(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Pr(r,t){return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]?Object.keys(r).map(function(e){return r[e]===t[e]}).reduce(function(e,r){return e?r:e},!0):0===Tr(new Set(r.filter(function(e){return!new Set(t).has(e)}))).length}function Mr(e){var r=e.map(function(e){return e.length}).reduce(function(e,r){return Math.max(e,r)},0);return Tr(Array(r).keys()).map(function(r){return e.map(function(e){return e[r]})})}function Ur(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(r,"t0",1);case 1:case"end":return e.stop()}},Rr,this)}function Lr(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=Ur(r);return function e(r){return r[0](t)?r[1](t):e(o.next().value)}(o.next().value)}function Vr(r,t){var n,o,u,s,i,c,l,a,f,m=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=2<m.length&&void 0!==m[2]?m[2]:function(){return!1},s=!(u=!(o=0)),i=void 0,e.prev=5,c=r[Symbol.iterator]();case 7:if(u=(l=c.next()).done){e.next=18;break}if(a=l.value,n())return e.abrupt("return");e.next=11;break;case 11:if(f=t(a,o++))return e.next=15,f;e.next=15;break;case 15:u=!0,e.next=7;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(5),s=!0,i=e.t0;case 24:e.prev=24,e.prev=25,u||null==c.return||c.return();case 27:if(e.prev=27,s)throw i;e.next=30;break;case 30:return e.finish(27);case 31:return e.finish(24);case 32:case"end":return e.stop()}},Dr,this,[[5,20,24,32],[25,,27,31]])}function Br(e,r){try{require("fs").writeFileSync(e,r)}catch(e){console.warn("File system module is not available.")}}function zr(e,r){if(FileReader&&File){var t=new FileReader;t.onload=function(e){return r(e.target.result)},t.readAsText(e)}}function Gr(e){return e.startsWith("/")||e.startsWith("./")?"file://".concat(e):e}function Wr(e){for(var r=arguments.length,t=new Array(1<r?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return t.reduce(function(e,r){return e.split(r[0]).join(r[1])},e)}function Yr(r){for(var e=arguments.length,t=new Array(1<e?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return t.filter(function(e){return r.includes(e)})}var Hr=function(e){function t(e){var r;return br(this,t),(r=Nr(this,Ar(t).call(this,Error))).message="".concat(e," not found. You maybe use a wrong path or url. Be sure you use absolute path, relative one being not supported."),r.name="FileNotFoundError",r}return Or(t,Er(Error)),t}(),Kr=function(e){function o(){var e;br(this,o),e=Nr(this,Ar(o).call(this,TypeError));for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return e.message="can't work with multiple variable types: [".concat(t.join(","),"]."),e.name="MixedTypeError",e}return Or(o,Er(TypeError)),o}(),Qr=function(e){function n(e,r){var t;return br(this,n),(t=Nr(this,Ar(n).call(this,Error))).message="".concat(e," not found in [").concat(r.join(", "),"]."),t.name="NoSuchColumnError",t}return Or(n,Er(Error)),n}(),Zr=function(e){function n(e,r){var t;return br(this,n),(t=Nr(this,Ar(n).call(this,Error))).message="[".concat(e.join(", "),"] while expecting [").concat(r.join(", "),"]."),t.name="WrongSchemaError",t}return Or(n,Er(Error)),n}(),Xr=function(e){function n(e,r){var t;return br(this,n),(t=Nr(this,Ar(n).call(this,TypeError))).message="".concat(e&&e.constructor?e.constructor.name:gr(e)," while expecting ").concat(r,"."),t.name="ArgumentTypeError",t}return Or(n,Er(TypeError)),n}(),$r=function(e){function t(e){var r;return br(this,t),(r=Nr(this,Ar(t).call(this,Error))).message="".concat(e,"."),r.name="SQLParseError",r}return Or(t,Er(Error)),t}(),et=function(e){function t(e){var r;return br(this,t),(r=Nr(this,Ar(t).call(this,Error))).message="The SQL temporary table ".concat(e," already exits. Use overwrite = true to overwrite it."),r.name="TableAlreadyExistsError",r}return Or(t,Er(Error)),t}(),rt=function(e){function t(e){var r;return br(this,t),(r=Nr(this,Ar(t).call(this,Error))).message="The SQL temporary table ".concat(e," is not allowed. Avoid to use Spaces, quotes, tabs...."),r.name="WrongTableNameError",r}return Or(t,Er(Error)),t}(),tt=Object.freeze({FileNotFoundError:Hr,MixedTypeError:Kr,NoSuchColumnError:Qr,WrongSchemaError:Zr,ArgumentTypeError:Xr,SQLParseError:$r,TableAlreadyExistsError:et,WrongTableNameError:rt}),nt=Symbol("columns"),ot=Symbol("values"),ut=function(){function n(e,r){if(br(this,n),!e)throw new Xr(e,"Row | Array | Object");this[nt]=r||Object.keys(e),this[ot]=Object.freeze(this._build(e))}return _r(n,[{key:Symbol.iterator,value:regeneratorRuntime.mark(function(){var r,t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.values(this[ot]),t=0;case 2:if(t<r.length)return n=r[t],e.next=6,n;e.next=9;break;case 6:t++,e.next=2;break;case 9:case"end":return e.stop()}},n,this)})},{key:"__newInstance__",value:function(e,r){var t;return Pr(this[nt],r)?Object.assign(Object.create(Object.getPrototypeOf(this)),this,(kr(t={},ot,e),kr(t,nt,Tr(r)),t)):new n(e,r)}},{key:"_build",value:function(e){var r=this;return Lr(e,[function(e){return e instanceof Array},function(){return r._fromArray(e)}],[function(e){return e instanceof n},function(){return r._fromObject(e[ot])}],[function(e){return e instanceof Object&&null!==e},function(){return r._fromObject(e)}],[function(){return!0},function(e){throw new Xr(e,"Row | Array | Object")}])}},{key:"_fromObject",value:function(r){return Object.assign.apply(Object,[{}].concat(Tr(this[nt].map(function(e){return kr({},e,r[e])}))))}},{key:"_fromArray",value:function(r){return Object.assign.apply(Object,[{}].concat(Tr(Object.entries(this[nt]).map(function(e){return kr({},e[1],r[e[0]])}))))}},{key:"toDict",value:function(){return Object.assign({},this[ot])}},{key:"toArray",value:function(){return Tr(this)}},{key:"size",value:function(){return this[nt].length}},{key:"hash",value:function(){return function(e){var r=0;if(0===e.length)return r;for(var t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r&=r;return r}(JSON.stringify(this[ot]))}},{key:"has",value:function(e){return this[nt].includes(e)}},{key:"select",value:function(){for(var r=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.__newInstance__(Object.assign.apply(Object,[{}].concat(Tr(t.map(function(e){return kr({},e,r.get(e))})))),t)}},{key:"get",value:function(e){if(!this.has(e))throw new Qr(e,this[nt]);return this[ot][e]}},{key:"set",value:function(e,r){var t=Object.assign({},this[ot],kr({},e,r));return this.__newInstance__(t,Object.keys(t))}},{key:"delete",value:function(r){if(!this.has(r))throw new Qr(r,this[nt]);return this.select.apply(this,Tr(this[nt].filter(function(e){return e!==r})))}}]),n}(),st=Symbol("groups"),it=Symbol("hashes"),ct=function(){function u(e){if(br(this,u),!(e instanceof mt))throw new Xr(e,"DataFrame");for(var r=arguments.length,t=new Array(1<r?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];var o=Cr(this._groupBy(e,t),2);this[st]=o[0],this[it]=o[1],this.df=e,this.on=0<t.length?t:e.listColumns()}return _r(u,[{key:Symbol.iterator,value:regeneratorRuntime.mark(function e(){var r,t,n,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!(r=!0),n=void 0,e.prev=3,o=this[it][Symbol.iterator]();case 5:if(r=(u=o.next()).done){e.next=12;break}return s=u.value,e.next=9,this[st][s];case 9:r=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),t=!0,n=e.t0;case 18:e.prev=18,e.prev=19,r||null==o.return||o.return();case 21:if(e.prev=21,t)throw n;e.next=24;break;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"_groupBy",value:function(n,o){var u={},e=[],r=!0,t=!1,s=void 0;try{for(var i,c=n.toCollection(!0)[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var l=i.value,a=l.select.apply(l,Tr(o)).hash();u[a]||(e.push(a),u[a]=[]),u[a].push(l)}}catch(e){t=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(t)throw s}}return[e.reduce(function(e,r){var t;return e[r]={groupKey:(t=u[r][0]).select.apply(t,Tr(o)).toDict(),hash:r,group:new mt(u[r],n.listColumns())},e},{}),e]}},{key:"get",value:function(e){return this[st][e]}},{key:"toCollection",value:function(){return Tr(this)}},{key:"show",value:function(){var o=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return Tr(this).map(function(e){var r=e.group,t=e.groupKey,n="--\n[".concat(JSON.stringify(t),"]\n--");return o||console.log(n),n+"\n"+r.show(10,o)}).reduce(function(e,r){return e+"\n"+r})}},{key:"listGroups",value:function(){return Tr(this).map(function(e){return e.groupKey})}},{key:"listHashs",value:function(){return this[it]}},{key:"map",value:function(r){var e,t=Tr(this).map(function(e){return e.group.map(r)});return this.df.__newInstance__((e=[]).concat.apply(e,Tr(t.map(function(e){return e.toCollection()}))),t[0].listColumns())}},{key:"filter",value:function(r){var e,t=Tr(this).map(function(e){return e.group.filter(r)}).filter(function(e){return 0<e.listColumns().length});return 0===t.length?this.df.__newInstance__([],this.df.listColumns()):this.df.__newInstance__((e=[]).concat.apply(e,Tr(t.map(function(e){return e.toCollection()}))),this.df.listColumns())}},{key:"chain",value:function(){for(var e,r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];var o=Tr(this).map(function(e){var r=e.group;return r.chain.apply(r,t)});return this.df.__newInstance__((e=[]).concat.apply(e,Tr(o.map(function(e){return e.toCollection()}))),o[0].listColumns())}},{key:"aggregate",value:function(n){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"aggregation";return this.df.__newInstance__(Tr(this).map(function(e){var r=e.group,t=e.groupKey;return qr({},t,kr({},o,n(r,t)))}),[].concat(Tr(this.on),[o]))}},{key:"pivot",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e){return e.count()},e=[].concat(Tr(this.on),Tr(this.df.distinct(t).toArray(t)));return this.df.__newInstance__(this.aggregate(function(e){return e.groupBy(t).aggregate(function(e,r){return kr({},r[t],n(e,r))}).toArray("aggregation").reduce(function(e,r){return qr({},e,r)},{})}).toCollection().map(function(e){var r=e.aggregation;return qr({},Ir(e,["aggregation"]),r)}),e)}},{key:"melt",value:function(){var u=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"variable",i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value",e=[].concat(Tr(this.on),[s,i]);return this.df.__newInstance__(this.aggregate(function(e){return Object.entries(e.toDict()).reduce(function(e,r){var t=Cr(r,2),n=t[0],o=t[1];return[].concat(Tr(e),Tr(o.reduce(function(e,r){var t;return u.on.includes(n)?e:[].concat(Tr(e),[(t={},kr(t,s,n),kr(t,i,r),t)])},[])))},[])}).toCollection().reduce(function(e,r){var t=r.aggregation,n=Ir(r,["aggregation"]);return[].concat(Tr(e),Tr(t.map(function(e){return qr({},n,e)})))},[]),e)}}]),u}(),lt=Symbol("columns"),at=Symbol("rows"),ft=Symbol.iterator,mt=function(){function i(e,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};br(this,i);var n=Cr(this._build(e,r),2);this[at]=n[0],this[lt]=n[1],this.options=t,this.options.modules=[].concat(Tr(i.defaultModules),Tr(this.options.modules||[])),Object.assign.apply(Object,[this].concat(Tr(this.__instanciateModules__(this.options.modules))))}return _r(i,null,[{key:"setDefaultModules",value:function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];i.defaultModules=r}},{key:"fromDSV",value:function(r){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:";",n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],o=jr.dsvFormat(e);return new Promise(function(t){var e=function(e){if(e.includes("Error: ENOENT"))return t(null);var r=n?o.parse(e):o.parseRows(e);return t(r)};return"string"==typeof r?vr.text(Gr(r),e):zr(r,e)}).then(function(e){if(null===e)throw new Hr(r);return new i(e)})}},{key:"fromText",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:";",t=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return i.fromDSV(e,r,t)}},{key:"fromCSV",value:function(e){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return i.fromDSV(e,",",r)}},{key:"fromTSV",value:function(e){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return i.fromDSV(e,"\t",r)}},{key:"fromPSV",value:function(e){var r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return i.fromDSV(e,"|",r)}},{key:"fromJSON",value:function(t){return new Promise(function(r){return"string"==typeof t?vr.json(Gr(t),r):zr(t,function(e){return r(JSON.parse(e))})}).then(function(e){if(null===e)throw new Hr(t);return new i(e)})}}]),_r(i,[{key:ft,value:regeneratorRuntime.mark(function e(){var r,t,n,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!(r=!0),n=void 0,e.prev=3,o=this[at][Symbol.iterator]();case 5:if(r=(u=o.next()).done){e.next=12;break}return s=u.value,e.next=9,s;case 9:r=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),t=!0,n=e.t0;case 18:e.prev=18,e.prev=19,r||null==o.return||o.return();case 21:if(e.prev=21,t)throw n;e.next=24;break;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])})},{key:"_columnsAreEquals",value:function(e){for(var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this[lt],t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];if(e[o]!==r[o])return!1}return!0}},{key:"__newInstance__",value:function(e,r){if(!(this._columnsAreEquals(r)&&e[0]instanceof ut))return new i(e,r,this.options);var t=Object.keys(e[0].toDict());if(!Pr(t,this[lt],!0))return new i(e,t,this.options);var n=new i([],[],this.options);return n[at]=Tr(e),n[lt]=Tr(r),n}},{key:"__instanciateModules__",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return e.map(function(e){var r=new e(n||t);return kr({},r.name,r)})}},{key:"_build",value:function(e,r){var t=this;return Lr(e,[function(e){return e instanceof i},function(){return t._fromArray(Tr(e[at]),r||e[lt])}],[function(e){return e instanceof Array&&0!==e.length},function(){return t._fromArray(e,r||Tr(new Set([].concat(Tr(e.slice(0,10)),Tr(e.slice(-10,-1))).map(function(e){return Object.keys(e)}).reduce(function(e,r){return[].concat(Tr(e),Tr(r))}))))}],[function(e){return e instanceof Array&&0===e.length},function(){return t._fromArray(e,r||[])}],[function(e){return e instanceof Object},function(){return t._fromDict(e,r||Object.keys(e))}],[function(){return!0},function(){throw new Xr(e,"DataFrame | Array | Object")}])}},{key:"_fromDict",value:function(e,r){return[Mr(Object.values(e)).map(function(e){return new ut(e,r)}),r]}},{key:"_fromArray",value:function(e,r){return[e.map(function(e){return new ut(e,r)}),r]}},{key:"_joinByType",value:function(e,c,l,a){var f=this,m=c.listHashs();return e.toCollection().map(function(e){var r=e.group,t=e.hash,n=m.includes(t),o=r;if(c.get(t)){var u=c.get(t).group.toCollection(),s=r.toCollection().map(function(r){return u.map(function(e){return Object.assign({},e,r)})}).reduce(function(e,r){return[].concat(Tr(e),Tr(r))},[]);o=f.__newInstance__(s,a)}var i=function(e){return!!e&&o};return"full"===l?o:i("out"===l?!n:n)}).filter(function(e){return e})}},{key:"_join",value:function(e,r,t){if(!(e instanceof i))throw new Xr(e,"DataFrame");var n=Tr(new Set([].concat(Tr(this.listColumns()),Tr(e.listColumns())))),o=Array.isArray(r)?r:[r],u=this.groupBy.apply(this,Tr(o)),s=e.groupBy.apply(e,Tr(o));return[this.__newInstance__([],n)].concat(Tr(Vr([].concat(Tr(t[0]?this._joinByType(u,s,t[0],n):[]),Tr(t[1]?this._joinByType(s,u,t[1],n):[])),function(e){return e.restructure(n)}))).reduce(function(e,r){return e.union(r)}).dropDuplicates()}},{key:"_cleanSavePath",value:function(e){return e.replace("file://","/")}},{key:"toDict",value:function(){var o=this;return Object.assign.apply(Object,[{}].concat(Tr(Object.entries(this.transpose().toArray()).map(function(e){var r=Cr(e,2),t=r[0],n=r[1];return kr({},o[lt][t],n)}))))}},{key:"toArray",value:function(r){return r?Tr(this).map(function(e){return e.get(r)}):Tr(this).map(function(e){return e.toArray()})}},{key:"toCollection",value:function(e){return e?Tr(this):Tr(this).map(function(e){return e.toDict()})}},{key:"toDSV",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:";",r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,n=jr.dsvFormat(e),o=r?n.format(this.toCollection(),this[lt]):n.formatRows(this.toArray());return t&&Br(this._cleanSavePath(t),o),o}},{key:"toText",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:";",r=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;return this.toDSV(e,r,t)}},{key:"toCSV",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return this.toDSV(",",e,r)}},{key:"toTSV",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return this.toDSV("\t",e,r)}},{key:"toPSV",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0;return this.toDSV("|",e,r)}},{key:"toJSON",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:void 0,t=JSON.stringify(e?this.toCollection():this.toDict());return r&&Br(this._cleanSavePath(r),t),t}},{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],t=function(e){return"| ".concat(e.map(function(e){var r=String(e);return 9<r.length?r.substring(0,6)+"...":r+Array(10-r.length).join(" ")}).join(" | ")," |")},n=t(this[lt]),o=0,u=[n,Array(n.length).join("-")].concat(Tr(Vr(this[at],function(e){return o++,t(e.toArray())},function(){return e<=o}))).join("\n");return r||console.log(u),u}},{key:"dim",value:function(){return[this.count(),this[lt].length]}},{key:"transpose",value:function(e){var r=[].concat(Tr(e?["rowNames"]:[]),Tr(Tr(Array(this.count()).keys()).reverse())),t=Mr((e?this.push(this[lt]):this).toArray());return this.__newInstance__(t,r.reverse()).restructure(r)}},{key:"count",value:function(){return this[at].length}},{key:"countValue",value:function(r){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this[lt][0];return this.filter(function(e){return e.get(t)===r}).count()}},{key:"push",value:function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return this.union(new i(r,this[lt]))}},{key:"replace",value:function(t,n,e){var r=this,o=Fr(e);return this.map(function(e){return(0<o.length?o:r[lt]).reduce(function(e,r){return e.get(r)===t?e.set(r,n):e},e)})}},{key:"distinct",value:function(e){return this.__newInstance__(kr({},e,Tr(new Set(this.toArray(e)))),[e])}},{key:"unique",value:function(e){return this.distinct(e)}},{key:"listColumns",value:function(){return Tr(this[lt])}},{key:"select",value:function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return this.__newInstance__(this[at].map(function(e){return e.select.apply(e,r)}),r)}},{key:"withColumn",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};return this.__newInstance__(this[at].map(function(e,r){return e.set(t,n(e,r))}),this[lt].includes(t)?this[lt]:[].concat(Tr(this[lt]),[t]))}},{key:"restructure",value:function(e){return this.__newInstance__(this[at],e)}},{key:"renameAll",value:function(e){if(e.length!==this[lt].length)throw new Zr(e,this[lt]);return this.__newInstance__(this.toArray(),e)}},{key:"rename",value:function(r,t){var e=this[lt].map(function(e){return e===r?t:e});return this.renameAll(e)}},{key:"castAll",value:function(t){var r=this;if(t.length!==this[lt].length)throw new Zr(t,this[lt]);return this.map(function(e){return new ut(e.toArray().map(function(e,r){return t[r](e)}),r[lt])})}},{key:"cast",value:function(r,t){return this.withColumn(r,function(e){return t(e.get(r))})}},{key:"drop",value:function(r){return this.__newInstance__(this[at].map(function(e){return e.delete(r)}),this[lt].filter(function(e){return e!==r}))}},{key:"chain",value:function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return this.__newInstance__(Tr(function(e){for(var r=arguments.length,t=new Array(1<r?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return Vr(e,t.reduce(function(o,u){return function(e,r){var t=o(e,r),n=!!t&&u(t,r);return!0===n?t:n}},function(e){return e}))}.apply(void 0,[this[at]].concat(r))),this[lt])}},{key:"filter",value:function(e){var t="object"===gr(e)?function(o){return Object.entries(e).map(function(e){var r=Cr(e,2),t=r[0],n=r[1];return Object.is(o.get(t),n)}).reduce(function(e,r){return e&&r})}:e,r=Tr(Vr(this[at],function(e,r){return!!t(e,r)&&e}));return 0<r.length?this.__newInstance__(r,this[lt]):this.__newInstance__([],[])}},{key:"where",value:function(e){return this.filter(e)}},{key:"find",value:function(e){return this.filter(e)[at][0]}},{key:"map",value:function(t){return this.__newInstance__(Tr(Vr(this[at],function(e,r){return t(e,r)})),this[lt])}},{key:"reduce",value:function(t,e){return void 0===e?this[at].reduce(function(e,r){return t(e,r)}):this[at].reduce(function(e,r){return t(e,r)},e)}},{key:"reduceRight",value:function(t,e){return void 0===e?this[at].reduceRight(function(e,r){return t(e,r)}):this[at].reduceRight(function(e,r){return t(e,r)},e)}},{key:"dropDuplicates",value:function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r&&0<r.length?r:this[lt];return this.groupBy.apply(this,Tr(n)).filter(function(e,r){return 0===r})}},{key:"shuffle",value:function(){return this.count()<2?this:this.__newInstance__(this.reduce(function(e,r){var t=Math.floor(Math.random()*(e.length-1)+1);return Array.isArray(e)?[].concat(Tr(e.slice(t,e.length+1)),[r],Tr(e.slice(0,t))):[e,r]}),this[lt])}},{key:"sample",value:function(e){var r=this.count()*e,t=0;return this.__newInstance__(Tr(Vr(this.shuffle()[at],function(e){return t++,e},function(){return r<=t})),this[lt])}},{key:"bisect",value:function(e){var r=this.count()*e,t=0,n=[];return[this.__newInstance__(Tr(Vr(this.shuffle()[at],function(e){if(t<r)return t++,e;n.push(e)})),this[lt]),this.__newInstance__(n,this[lt])]}},{key:"groupBy",value:function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return Sr(ct,[this].concat(r))}},{key:"sortBy",value:function(e){var s=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=Array.from(new Set(Fr(e))),t=this[at].sort(function(o,u){return r.map(function(e){var r=[o.get(e),u.get(e)],t=r[0],n=r[1];if(gr(t)!==gr(n))throw new Kr;return function(e,r){var t=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return r<e?t?-1:1:e<r?t?1:-1:0}(t,n,s)}).reduce(function(e,r){return e||r})});return this.__newInstance__(t,this[lt])}},{key:"union",value:function(e){if(!(e instanceof i))throw new Xr(e,"DataFrame");if(!Pr(this[lt],e[lt]))throw new Zr(e[lt],this[lt]);return this.__newInstance__([].concat(Tr(this),Tr(e.restructure(this[lt]))),this[lt])}},{key:"join",value:function(e,r){var t=this;return{inner:function(){return t.innerJoin(e,r)},full:function(){return t.fullJoin(e,r)},outer:function(){return t.outerJoin(e,r)},left:function(){return t.leftJoin(e,r)},right:function(){return t.rightJoin(e,r)}}[2<arguments.length&&void 0!==arguments[2]?arguments[2]:"inner"]()}},{key:"innerJoin",value:function(e,r){return this._join(e,r,["in"])}},{key:"fullJoin",value:function(e,r){return this._join(e,r,["full","full"])}},{key:"outerJoin",value:function(e,r){return this.fullJoin(e,r)}},{key:"leftJoin",value:function(e,r){return this._join(e,r,["full","in"])}},{key:"rightJoin",value:function(e,r){return this._join(e,r,["in","full"])}},{key:"diff",value:function(e,r){return this._join(e,r,["out","out"])}}]),i}();kr(mt,"defaultModules",[]);var dt=function(){function r(e){br(this,r),this.df=e,this.name="stat"}return _r(r,[{key:"_castAsNumber",value:function(r){return this.df.withColumn(r,function(e){return Number(e.get(r))}).filter(function(e){return!Number.isNaN(e.get(r))})}},{key:"sum",value:function(t){return Number(this.df.reduce(function(e,r){return Jr(r.get(t))?e+Number(r.get(t)):e},0))}},{key:"max",value:function(t){return this._castAsNumber(t).reduce(function(e,r){return r.get(t)>e.get(t)?r:e}).get(t)}},{key:"min",value:function(t){return this._castAsNumber(t).reduce(function(e,r){return e.get(t)>r.get(t)?r:e}).get(t)}},{key:"mean",value:function(t){var e=this.df.filter(function(e){return Jr(e.get(t))});return Number(e.reduce(function(e,r){return Jr(r.get(t))?e+Number(r.get(t)):e},0))/e.count()}},{key:"average",value:function(e){return this.mean(e)}},{key:"var",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.df.filter(function(e){return Jr(e.get(t))}),n=this.mean(t);return Number(r.reduce(function(e,r){return e+Math.pow(r.get(t)-n,2)},0))/(r.count()-(e?0:1))}},{key:"sd",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return Math.sqrt(this.var(e,r))}},{key:"stats",value:function(e){return{sum:this.sum(e),mean:this.mean(e),min:this.min(e),max:this.max(e),var:this.var(e),varpop:this.var(e,!0),sd:this.sd(e),sdpop:this.sd(e,!0)}}}]),r}(),ht=function(){function r(e){br(this,r),this.df=e,this.name="matrix"}return _r(r,[{key:"isCommutative",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!(e instanceof mt))throw new Xr(e,"DataFrame");return Pr(this.df.dim(),r?e.dim().reverse():e.dim(),!0)}},{key:"add",value:function(n){var o=this;if(!this.isCommutative(n))throw new Zr(this.df.dim(),n.dim());var u=Tr(Array(this.df.dim()[1]).keys());return this.df.__newInstance__(Tr(Vr(Object.keys(Tr(this.df)),function(e){var r=Tr(o.df)[e].toArray(),t=Tr(n)[e].toArray();return u.map(function(e){return r[e]+t[e]})})),this.df.listColumns())}},{key:"product",value:function(r){if("number"!=typeof r)throw new Xr(r,"Number");return this.df.map(function(e){return e.toArray().map(function(e){return e*r})})}},{key:"dot",value:function(r){var t=this;if(!this.isCommutative(r,!0))throw new Zr(this.df.dim(),r.dim().reverse());var o=Tr(Array(this.df.dim()[0]).keys());return this.df.__newInstance__(Tr(Vr(Object.keys(Tr(this.df)),function(e){var n=Tr(t.df)[e].toArray();return Tr(Vr(o,function(e){var t=Tr(r.transpose())[e].toArray();return Object.keys(t).reduce(function(e,r){return e+t[r]*n[r]},0)}))})),o)}}]),r}(),pt=[["INNER JOIN","INNERJOIN"],["LEFT JOIN","LEFTJOIN"],["RIGHT JOIN","RIGHTJOIN"],["FULL JOIN","FULLJOIN"],["GROUP BY","GROUPBY"]],yt={IN:function(e,r){return r.includes(e)},LIKE:function(e,r){return r.includes(e)||e.includes(r)},">=":function(e,r){return r<=e},"<=":function(e,r){return e<=r},"!=":function(e,r){return e!==r},"<":function(e,r){return e<r},">":function(e,r){return r<e},"=":function(e,r){return e===r},AND:function(e,r){return e&&r},OR:function(e,r){return e||r}},vt={COUNT:function(e){return e.count()},SUM:function(e,r){return e.stat.sum(r)},MAX:function(e,r){return e.stat.max(r)},MIN:function(e,r){return e.stat.min(r)},AVG:function(e,r){return e.stat.mean(r)}};function jt(e){return Wr(e.join(" "),[" ",""]).split(",")}function gt(r,t,n){var o=r.findIndex(function(e){return"ON"===e.toUpperCase()})+1;return function(e){return e.join(t[r[0]],jt(r.filter(function(e,r){return o<=r})),n)}}var bt={WHERE:function(r){var o=function(e){for(var r=arguments.length,t=new Array(1<r?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return t.reduce(function(e,r){return e.map(function(e){return e.split(r)}).reduce(function(e,r){return[].concat(Tr(e),Tr(r))},[])},[e])}(r.join(" ")," AND "," OR ");return function(e){return e.filter(function(n){var t=r.filter(function(e){return["AND","OR"].includes(e.toUpperCase())});return o.map(function(e){var r=Yr.apply(void 0,[e].concat(Tr(Object.keys(yt))))[0],t=e.split(r).map(function(e){return e.trim()});return!n.has(t[0])&&n.has(t[1])?yt[r](Wr(t[0].trim(),['"',""],["'",""],["`",""]),String(n.get(t[1]))):yt[r](String(n.get(t[0])),Wr(t[1].trim(),['"',""],["'",""],["`",""]))}).reduce(function(e,r){return yt[t.shift()](e,r)})})}},JOIN:function(e,r){return gt(e,r,"inner")},INNERJOIN:function(e,r){return gt(e,r,"inner")},LEFTJOIN:function(e,r){return gt(e,r,"left")},RIGHTJOIN:function(e,r){return gt(e,r,"right")},FULLJOIN:function(e,r){return gt(e,r,"full")},UNION:function(r,t){return function(e){return e.union(r[0].toUpperCase().includes("SELECT")?_t(r.join(" "),t):t[r[0]])}},GROUPBY:function(r){return function(e){return e.groupBy.apply(e,Tr(jt(r)))}}};function wt(e){var r,o,t=(r=e,o=r,pt.forEach(function(e){var r=Cr(e,2),t=r[0],n=r[1];o=o.replace(t,n).replace(t.toLowerCase(),n)}),o).split(" "),n=t.findIndex(function(e){return"FROM"===e.toUpperCase()});if(-1===n)throw new $r("Your query should contains FROM keyword");return{selections:t.slice(0,n),table:t[n+1],operations:t.slice(n+2,t.length)}}function _t(e,r){var t=wt(e),n=t.selections,o=t.table,u=t.operations;if(!o||!Object.keys(r).includes(o))throw new $r("Wrong table name in your query: ".concat(o));var s,i,c,l=(i=r,(c=(s=u).map(function(e,r){return Object.keys(bt).includes(e.toUpperCase())?r:void 0}).filter(function(e){return void 0!==e})).map(function(e,r){return bt[s[e].toUpperCase()](s.slice(e+1,c[r+1]?c[r+1]:s.length),i)}).reduce(function(r,t){return function(e){return t(r(e))}},function(e){return e}));return function(e){if("SELECT"!==e[0].toUpperCase())throw new $r("Your query should begin with SELECT keyword");return e.shift(),Lr(e.join(" ").split(",").map(function(e){return e.trim()}),[function(e){return"*"===Wr(e[0],[" ",""])},function(){return function(e){return e}}],[function(e){return e[0].toUpperCase().includes("DISTINCT")},function(r){var t=Wr(r[0].split(" AS ")[0],["DISTINCT",""],["distinct",""],[" ",""]);return function(e){return e.distinct(t).rename(t,r[0].includes("AS")?r[0].split("AS")[1].replace(" ",""):t)}}],[function(e){return Yr.apply(void 0,[e[0].toUpperCase()].concat(Tr(Object.keys(vt))))[0]},function(n){return function(e){var r=Object.keys(vt).find(function(e){return n[0].toUpperCase().includes(e)}),t=function(e){return vt[r](e,Wr(n[0],["".concat(r.toLowerCase(),"("),""],["".concat(r,"("),""],["(",""],[")",""]))};return e.on&&e.df?e.aggregate(t):t(e)}}],[function(){return!0},function(r){return function(e){return e.select.apply(e,Tr(r.map(function(e){return e.split(" AS ")[0].replace(" ","")}))).renameAll(r.map(function(e){return e.includes("AS")?e.split("AS")[1].replace(" ",""):e}))}}])}(n)(l(r[o]))}var kt=function(){function n(e){br(this,n),this.df=e,this.name="sql"}return _r(n,null,[{key:"request",value:function(e){if("string"!=typeof e)throw new Xr(e,"Stri g");return _t(e,n.tables)}},{key:"dropTables",value:function(){n.tables={}}},{key:"dropTable",value:function(e){delete n.tables[e]}},{key:"renameTable",value:function(e,r){var t=2<arguments.length&&void 0!==arguments[2]&&arguments[2];n.registerTable(n.tables[e],r,t),n.dropTable(e)}},{key:"listTables",value:function(){return Object.keys(n.tables)}},{key:"registerTable",value:function(e,r){var t=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!(e instanceof mt))throw new Xr(e,"DataFrame");if(!new RegExp("^[a-zA-Z_][a-zA-Z0-9_]*$").test(r))throw new rt(r);if(n.listTables().includes(r)&&!t)throw new et(r);n.tables[r]=e}}]),_r(n,[{key:"register",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return n.registerTable(this.df,e,r),this.df}}]),n}();kt.tables={},mt.setDefaultModules(dt,ht,kt),mt.sql=kt,e.DataFrame=mt,e.Row=ut,e.Errors=tt,e.default=mt,Object.defineProperty(e,"__esModule",{value:!0})});
